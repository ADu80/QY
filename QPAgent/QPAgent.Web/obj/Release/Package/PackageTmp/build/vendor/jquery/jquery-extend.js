!function(t){"function"==typeof define&&define.amd?define("datepicker",["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function e(t){return j.call(t).slice(8,-1).toLowerCase()}function i(t){return"string"==typeof t}function a(t){return"number"==typeof t&&!isNaN(t)}function s(t){return"undefined"==typeof t}function n(t){return"date"===e(t)}function r(t,e){var i=[];return Array.from?Array.from(t).slice(e||0):(a(e)&&i.push(e),i.slice.apply(t,i))}function h(t,e){var i=r(arguments,2);return function(){return t.apply(e,i.concat(r(arguments)))}}function o(t){return t%4===0&&t%100!==0||t%400===0}function l(t,e){return[31,o(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]}function d(t){var e,i,a=String(t).toLowerCase(),s=a.match($);if(!s||0===s.length)throw new Error("Invalid date format.");for(t={source:a,parts:s},e=s.length,i=0;i<e;i++)switch(s[i]){case"dd":case"d":t.hasDay=!0;break;case"mm":case"m":t.hasMonth=!0;break;case"yyyy":case"yy":t.hasYear=!0}return t}function c(e,i){i=t.isPlainObject(i)?i:{},i.language&&(i=t.extend({},c.LANGUAGES[i.language],i)),this.$element=t(e),this.options=t.extend({},c.DEFAULTS,i),this.isBuilt=!1,this.isShown=!1,this.isInput=!1,this.isInline=!1,this.initialValue="",this.initialDate=null,this.startDate=null,this.endDate=null,this.init()}var u=t(window),f=window.document,p=t(f),m=window.Number,w="datepicker",g="click."+w,v="keyup."+w,y="focus."+w,D="resize."+w,k="show."+w,b="hide."+w,x="pick."+w,$=/(y|m|d)+/g,C=/\d+/g,S=/^\d{2,4}$/,F=w+"-inline",M=w+"-dropdown",V=w+"-top-left",I=w+"-top-right",Y=w+"-bottom-left",T=w+"-bottom-right",P=[V,I,Y,T].join(" "),A=w+"-hide",N=Math.min,j=Object.prototype.toString;c.prototype={constructor:c,init:function(){var e=this.options,i=this.$element,a=e.startDate,s=e.endDate,n=e.date;this.$trigger=t(e.trigger||i),this.isInput=i.is("input")||i.is("textarea"),this.isInline=e.inline&&(e.container||!this.isInput),this.format=d(e.format),this.oldValue=this.initialValue=this.getValue(),n=this.parseDate(n||this.initialValue),a&&(a=this.parseDate(a),n.getTime()<a.getTime()&&(n=new Date(a)),this.startDate=a),s&&(s=this.parseDate(s),a&&s.getTime()<a.getTime()&&(s=new Date(a)),n.getTime()>s.getTime()&&(n=new Date(s)),this.endDate=s),this.date=n,this.viewDate=new Date(n),this.initialDate=new Date(this.date),this.bind(),(e.autoShow||this.isInline)&&this.show(),e.autoPick&&this.pick()},build:function(){var e,i=this.options,a=this.$element;this.isBuilt||(this.isBuilt=!0,this.$picker=e=t(i.template),this.$week=e.find('[data-view="week"]'),this.$yearsPicker=e.find('[data-view="years picker"]'),this.$yearsPrev=e.find('[data-view="years prev"]'),this.$yearsNext=e.find('[data-view="years next"]'),this.$yearsCurrent=e.find('[data-view="years current"]'),this.$years=e.find('[data-view="years"]'),this.$monthsPicker=e.find('[data-view="months picker"]'),this.$yearPrev=e.find('[data-view="year prev"]'),this.$yearNext=e.find('[data-view="year next"]'),this.$yearCurrent=e.find('[data-view="year current"]'),this.$months=e.find('[data-view="months"]'),this.$daysPicker=e.find('[data-view="days picker"]'),this.$monthPrev=e.find('[data-view="month prev"]'),this.$monthNext=e.find('[data-view="month next"]'),this.$monthCurrent=e.find('[data-view="month current"]'),this.$days=e.find('[data-view="days"]'),this.isInline?t(i.container||a).append(e.addClass(F)):(t(f.body).append(e.addClass(M)),e.addClass(A)),this.fillWeek())},unbuild:function(){this.isBuilt&&(this.isBuilt=!1,this.$picker.remove())},bind:function(){var e=this.options,i=this.$element;t.isFunction(e.show)&&i.on(k,e.show),t.isFunction(e.hide)&&i.on(b,e.hide),t.isFunction(e.pick)&&i.on(x,e.pick),this.isInput&&(i.on(v,t.proxy(this.keyup,this)),e.trigger||i.on(y,t.proxy(this.show,this))),this.$trigger.on(g,t.proxy(this.show,this))},unbind:function(){var e=this.options,i=this.$element;t.isFunction(e.show)&&i.off(k,e.show),t.isFunction(e.hide)&&i.off(b,e.hide),t.isFunction(e.pick)&&i.off(x,e.pick),this.isInput&&(i.off(v,this.keyup),e.trigger||i.off(y,this.show)),this.$trigger.off(g,this.show)},showView:function(t){var e=this.$yearsPicker,i=this.$monthsPicker,a=this.$daysPicker,s=this.format;if(s.hasYear||s.hasMonth||s.hasDay)switch(m(t)){case 2:case"years":i.addClass(A),a.addClass(A),s.hasYear?(this.fillYears(),e.removeClass(A)):this.showView(0);break;case 1:case"months":e.addClass(A),a.addClass(A),s.hasMonth?(this.fillMonths(),i.removeClass(A)):this.showView(2);break;default:e.addClass(A),i.addClass(A),s.hasDay?(this.fillDays(),a.removeClass(A)):this.showView(1)}},hideView:function(){this.options.autoHide&&this.hide()},place:function(){var t=this.options,e=this.$element,i=this.$picker,a=p.outerWidth(),s=p.outerHeight(),n=e.outerWidth(),r=e.outerHeight(),h=i.width(),o=i.height(),l=e.offset(),d=l.left,c=l.top,u=parseFloat(t.offset)||10,f=V;c>o&&c+r+o>s?(c-=o+u,f=Y):c+=r+u,d+h>a&&(d=d+n-h,f=f.replace("left","right")),i.removeClass(P).addClass(f).css({top:c,left:d,zIndex:parseInt(t.zIndex,10)})},trigger:function(e,i){var a=t.Event(e,i);return this.$element.trigger(a),a},createItem:function(e){var i=this.options,a=i.itemTag,s={text:"",view:"",muted:!1,picked:!1,disabled:!1};return t.extend(s,e),"<"+a+" "+(s.disabled?'class="'+i.disabledClass+'"':s.picked?'class="'+i.pickedClass+'"':s.muted?'class="'+i.mutedClass+'"':"")+(s.view?' data-view="'+s.view+'"':"")+">"+s.text+"</"+a+">"},fillAll:function(){this.fillYears(),this.fillMonths(),this.fillDays()},fillWeek:function(){var e,i=this.options,a=parseInt(i.weekStart,10)%7,s=i.daysMin,n="";for(s=t.merge(s.slice(a),s.slice(0,a)),e=0;e<=6;e++)n+=this.createItem({text:s[e]});this.$week.html(n)},fillYears:function(){var e,i=this.options,a=i.disabledClass||"",s=i.yearSuffix||"",n=t.isFunction(i.filter)&&i.filter,r=this.startDate,h=this.endDate,o=this.viewDate,l=o.getFullYear(),d=o.getMonth(),c=o.getDate(),u=this.date,f=u.getFullYear(),p=!1,m=!1,w=!1,g=!1,v=!1,y="",D=-5,k=6;for(e=D;e<=k;e++)u=new Date(l+e,d,c),v=e===D||e===k,g=l+e===f,w=!1,r&&(w=u.getFullYear()<r.getFullYear(),e===D&&(p=w)),!w&&h&&(w=u.getFullYear()>h.getFullYear(),e===k&&(m=w)),!w&&n&&(w=n.call(this.$element,u)===!1),y+=this.createItem({text:l+e,view:w?"year disabled":g?"year picked":"year",muted:v,picked:g,disabled:w});this.$yearsPrev.toggleClass(a,p),this.$yearsNext.toggleClass(a,m),this.$yearsCurrent.toggleClass(a,!0).html(l+D+s+" - "+(l+k)+s),this.$years.html(y)},fillMonths:function(){var e,i=this.options,a=i.disabledClass||"",s=i.monthsShort,n=t.isFunction(i.filter)&&i.filter,r=this.startDate,h=this.endDate,o=this.viewDate,l=o.getFullYear(),d=o.getDate(),c=this.date,u=c.getFullYear(),f=c.getMonth(),p=!1,m=!1,w=!1,g=!1,v="";for(e=0;e<=11;e++)c=new Date(l,e,d),g=l===u&&e===f,w=!1,r&&(p=c.getFullYear()===r.getFullYear(),w=p&&c.getMonth()<r.getMonth()),!w&&h&&(m=c.getFullYear()===h.getFullYear(),w=m&&c.getMonth()>h.getMonth()),!w&&n&&(w=n.call(this.$element,c)===!1),v+=this.createItem({index:e,text:s[e],view:w?"month disabled":g?"month picked":"month",picked:g,disabled:w});this.$yearPrev.toggleClass(a,p),this.$yearNext.toggleClass(a,m),this.$yearCurrent.toggleClass(a,p&&m).html(l+i.yearSuffix||""),this.$months.html(v)},fillDays:function(){var e,i,a,s=this.options,n=s.disabledClass||"",r=s.yearSuffix||"",h=s.monthsShort,o=parseInt(s.weekStart,10)%7,d=t.isFunction(s.filter)&&s.filter,c=this.startDate,u=this.endDate,f=this.viewDate,p=f.getFullYear(),m=f.getMonth(),w=p,g=m,v=p,y=m,D=this.date,k=D.getFullYear(),b=D.getMonth(),x=D.getDate(),$=!1,C=!1,S=!1,F=!1,M=[],V=[],I=[],Y=42;for(0===m?(w-=1,g=11):g-=1,e=l(w,g),D=new Date(p,m,1),a=D.getDay()-o,a<=0&&(a+=7),c&&($=D.getTime()<=c.getTime()),i=e-(a-1);i<=e;i++)D=new Date(w,g,i),S=!1,c&&(S=D.getTime()<c.getTime()),!S&&d&&(S=d.call(this.$element,D)===!1),M.push(this.createItem({text:i,view:"day prev",muted:!0,disabled:S}));for(11===m?(v+=1,y=0):y+=1,e=l(p,m),a=Y-(M.length+e),D=new Date(p,m,e),u&&(C=D.getTime()>=u.getTime()),i=1;i<=a;i++)D=new Date(v,y,i),S=!1,u&&(S=D.getTime()>u.getTime()),!S&&d&&(S=d.call(this.$element,D)===!1),V.push(this.createItem({text:i,view:"day next",muted:!0,disabled:S}));for(i=1;i<=e;i++)D=new Date(p,m,i),F=p===k&&m===b&&i===x,S=!1,c&&(S=D.getTime()<c.getTime()),!S&&u&&(S=D.getTime()>u.getTime()),!S&&d&&(S=d.call(this.$element,D)===!1),I.push(this.createItem({text:i,view:S?"day disabled":F?"day picked":"day",picked:F,disabled:S}));this.$monthPrev.toggleClass(n,$),this.$monthNext.toggleClass(n,C),this.$monthCurrent.toggleClass(n,$&&C).html(s.yearFirst?p+r+" "+h[m]:h[m]+" "+p+r),this.$days.html(M.join("")+I.join(" ")+V.join(""))},click:function(e){var i,a,s,n,r,h,o=t(e.target),l=this.viewDate;if(e.stopPropagation(),e.preventDefault(),!o.hasClass("disabled"))switch(i=l.getFullYear(),a=l.getMonth(),s=l.getDate(),h=o.data("view")){case"years prev":case"years next":i="years prev"===h?i-10:i+10,r=o.text(),n=S.test(r),n&&(i=parseInt(r,10),this.date=new Date(i,a,N(s,28))),this.viewDate=new Date(i,a,N(s,28)),this.fillYears(),n&&(this.showView(1),this.pick("year"));break;case"year prev":case"year next":i="year prev"===h?i-1:i+1,this.viewDate=new Date(i,a,N(s,28)),this.fillMonths();break;case"year current":this.format.hasYear&&this.showView(2);break;case"year picked":this.format.hasMonth?this.showView(1):this.hideView();break;case"year":i=parseInt(o.text(),10),this.date=new Date(i,a,N(s,28)),this.viewDate=new Date(i,a,N(s,28)),this.format.hasMonth?this.showView(1):this.hideView(),this.pick("year");break;case"month prev":case"month next":a="month prev"===h?a-1:"month next"===h?a+1:a,this.viewDate=new Date(i,a,N(s,28)),this.fillDays();break;case"month current":this.format.hasMonth&&this.showView(1);break;case"month picked":this.format.hasDay?this.showView(0):this.hideView();break;case"month":a=t.inArray(o.text(),this.options.monthsShort),this.date=new Date(i,a,N(s,28)),this.viewDate=new Date(i,a,N(s,28)),this.format.hasDay?this.showView(0):this.hideView(),this.pick("month");break;case"day prev":case"day next":case"day":a="day prev"===h?a-1:"day next"===h?a+1:a,s=parseInt(o.text(),10),this.date=new Date(i,a,s),this.viewDate=new Date(i,a,s),this.fillDays(),"day"===h&&this.hideView(),this.pick("day");break;case"day picked":this.hideView(),this.pick("day")}},clickDoc:function(t){for(var e,i=t.target,a=this.$trigger[0];i!==f;){if(i===a){e=!0;break}i=i.parentNode}e||this.hide()},keyup:function(){this.update()},getValue:function(){var t=this.$element,e="";return this.isInput?e=t.val():this.isInline?this.options.container&&(e=t.text()):e=t.text(),e},setValue:function(t){var e=this.$element;t=i(t)?t:"",this.isInput?e.val(t):this.isInline?this.options.container&&e.text(t):e.text(t)},show:function(){this.isBuilt||this.build(),this.isShown||this.trigger(k).isDefaultPrevented()||(this.isShown=!0,this.$picker.removeClass(A).on(g,t.proxy(this.click,this)),this.showView(this.options.startView),this.isInline||(u.on(D,this._place=h(this.place,this)),p.on(g,this._clickDoc=h(this.clickDoc,this)),this.place()))},hide:function(){this.isShown&&(this.trigger(b).isDefaultPrevented()||(this.isShown=!1,this.$picker.addClass(A).off(g,this.click),this.isInline||(u.off(D,this._place),p.off(g,this._clickDoc))))},update:function(){var t=this.getValue();t!==this.oldValue&&(this.setDate(t,!0),this.oldValue=t)},pick:function(t){var e=this.$element,i=this.date;this.trigger(x,{view:t||"",date:i}).isDefaultPrevented()||(this.setValue(i=this.formatDate(this.date)),this.isInput&&e.trigger("change"))},reset:function(){this.setDate(this.initialDate,!0),this.setValue(this.initialValue),this.isShown&&this.showView(this.options.startView)},getMonthName:function(e,i){var n=this.options,r=n.months;return t.isNumeric(e)?e=m(e):s(i)&&(i=e),i===!0&&(r=n.monthsShort),r[a(e)?e:this.date.getMonth()]},getDayName:function(e,i,n){var r=this.options,h=r.days;return t.isNumeric(e)?e=m(e):(s(n)&&(n=i),s(i)&&(i=e)),h=n===!0?r.daysMin:i===!0?r.daysShort:h,h[a(e)?e:this.date.getDay()]},getDate:function(t){var e=this.date;return t?this.formatDate(e):new Date(e)},setDate:function(e,a){var s=this.options.filter;if(n(e)||i(e)){if(e=this.parseDate(e),t.isFunction(s)&&s.call(this.$element,e)===!1)return;this.date=e,this.viewDate=new Date(e),a||this.pick(),this.isBuilt&&this.fillAll()}},setStartDate:function(t){(n(t)||i(t))&&(this.startDate=this.parseDate(t),this.isBuilt&&this.fillAll())},setEndDate:function(t){(n(t)||i(t))&&(this.endDate=this.parseDate(t),this.isBuilt&&this.fillAll())},parseDate:function(t){var e,a,s,r,h,o,l=this.format,d=[];if(n(t))return new Date(t.getFullYear(),t.getMonth(),t.getDate());if(i(t)&&(d=t.match(C)||[]),t=new Date,a=t.getFullYear(),s=t.getDate(),r=t.getMonth(),e=l.parts.length,d.length===e)for(o=0;o<e;o++)switch(h=parseInt(d[o],10)||1,l.parts[o]){case"dd":case"d":s=h;break;case"mm":case"m":r=h-1;break;case"yy":a=2e3+h;break;case"yyyy":a=h}return new Date(a,r,s)},formatDate:function(t){var e,i,a,s,r,h=this.format,o="";if(n(t))for(o=h.source,i=t.getFullYear(),s={d:t.getDate(),m:t.getMonth()+1,yy:i.toString().substring(2),yyyy:i},s.dd=(s.d<10?"0":"")+s.d,s.mm=(s.m<10?"0":"")+s.m,e=h.parts.length,r=0;r<e;r++)a=h.parts[r],o=o.replace(a,s[a]);return o},destroy:function(){this.unbind(),this.unbuild(),this.$element.removeData(w)}},c.LANGUAGES={},c.DEFAULTS={autoShow:!1,autoHide:!1,autoPick:!1,inline:!1,container:null,trigger:null,language:"",format:"mm/dd/yyyy",date:null,startDate:null,endDate:null,startView:0,weekStart:0,yearFirst:!1,yearSuffix:"",days:["周日","周一","周二","周三","周四","周五","周六"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["周日","周一","周二","周三","周四","周五","周六"],months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],itemTag:"li",mutedClass:"muted",pickedClass:"picked",disabledClass:"disabled",template:'<div class="datepicker-container"><div class="datepicker-panel" data-view="years picker"><ul><li data-view="years prev">&lsaquo;</li><li data-view="years current"></li><li data-view="years next">&rsaquo;</li></ul><ul data-view="years"></ul></div><div class="datepicker-panel" data-view="months picker"><ul><li data-view="year prev">&lsaquo;</li><li data-view="year current"></li><li data-view="year next">&rsaquo;</li></ul><ul data-view="months"></ul></div><div class="datepicker-panel" data-view="days picker"><ul class="yearmonths"><li data-view="month prev">&lsaquo;</li><li data-view="month current"></li><li data-view="month next">&rsaquo;</li></ul><ul data-view="week"></ul><ul data-view="days"></ul></div></div>',offset:10,zIndex:1e3,filter:null,show:null,hide:null,pick:null},c.setDefaults=function(e){e=t.isPlainObject(e)?e:{},e.language&&(e=t.extend({},c.LANGUAGES[e.language],e)),t.extend(c.DEFAULTS,e)},c.other=t.fn.datepicker,t.fn.datepicker=function(e){var a,n=r(arguments,1);return this.each(function(){var s,r,h=t(this),o=h.data(w);if(!o){if(/destroy/.test(e))return;s=t.extend({},h.data(),t.isPlainObject(e)&&e),h.data(w,o=new c(this,s))}i(e)&&t.isFunction(r=o[e])&&(a=r.apply(o,n))}),s(a)?this:a},t.fn.datepicker.Constructor=c,t.fn.datepicker.languages=c.LANGUAGES,t.fn.datepicker.setDefaults=c.setDefaults,t.fn.datepicker.noConflict=function(){return t.fn.datepicker=c.other,this}}),function(t){var e=t(document).data("func",{});t.smartMenu=t.noop,t.fn.smartMenu=function(i,a){var s=t("body"),n={name:"",offsetX:2,offsetY:2,textLimit:6,beforeShow:t.noop,afterShow:t.noop},r=t.extend(n,a||{}),h=function(a){var s=a||i,n=a?Math.random().toString():r.name,o="",l="smart_menu_";return t.isArray(s)&&s.length&&(o='<div id="smartMenu_'+n+'" class="'+l+'box"><div class="'+l+'body"><ul class="'+l+'ul">',t.each(s,function(i,a){i&&(o=o+'<li class="'+l+'li_separate">&nbsp;</li>'),t.isArray(a)&&t.each(a,function(i,a){var s=a.text,n="",d="",c=Math.random().toString().replace(".","");if(s){s.length>r.textLimit&&(s=s.slice(0,r.textLimit)+"…",d=' title="'+a.text+'"'),n=t.isArray(a.data)&&a.data.length?'<li class="'+l+'li" data-hover="true">'+h(a.data)+'<a href="javascript:" class="'+l+'a"'+d+' data-key="'+c+'"><i class="'+l+'triangle"></i>'+s+"</a></li>":'<li class="'+l+'li"><a href="javascript:" class="'+l+'a"'+d+' data-key="'+c+'">'+s+"</a></li>",o+=n;var u=e.data("func");u[c]=a.func,e.data("func",u)}})}),o+="</ul></div></div>"),o},o=function(){var i="#smartMenu_",a="smart_menu_",s=t(i+r.name);return s.size()?s:(t("body").append(h()),t(i+r.name+" a").bind("click",function(){var i=t(this).attr("data-key"),a=e.data("func")[i];return t.isFunction(a)&&a.call(e.data("trigger")),t.smartMenu.hide(),!1}),t(i+r.name+" li").each(function(){var e=t(this).attr("data-hover"),i=a+"li_hover";t(this).hover(function(){var s=t(this).siblings("."+i);s.removeClass(i).children("."+a+"box").hide(),s.children("."+a+"a").removeClass(a+"a_hover"),e&&(t(this).addClass(i).children("."+a+"box").show(),t(this).children("."+a+"a").addClass(a+"a_hover"))})}),t(i+r.name))};t(this).each(function(){this.oncontextmenu=function(i){t.isFunction(r.beforeShow)&&r.beforeShow.call(this),i=i||window.event,i.cancelBubble=!0,i.stopPropagation&&i.stopPropagation(),t.smartMenu.hide();var a=e.scrollTop(),s=o();if(s)return s.css({display:"block",left:i.clientX+r.offsetX,top:i.clientY+a+r.offsetY}),e.data("target",s),e.data("trigger",this),t.isFunction(r.afterShow)&&r.afterShow.call(this),!1}}),s.data("bind")||s.bind("click",t.smartMenu.hide).data("bind",!0)},t.extend(t.smartMenu,{hide:function(){var t=e.data("target");t&&"block"===t.css("display")&&t.hide()},remove:function(){var t=e.data("target");t&&t.remove()}})}(jQuery);